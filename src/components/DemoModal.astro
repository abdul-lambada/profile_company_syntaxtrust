<div
    id="demo-modal"
    class="fixed inset-0 z-100 hidden items-center justify-center"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
>
    <!-- Backdrop -->
    <div
        class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity opacity-0"
        id="demo-backdrop"
    >
    </div>

    <!-- Modal Content -->
    <div
        class="relative bg-white rounded-3xl shadow-2xl w-full max-w-lg mx-4 overflow-hidden transform scale-95 opacity-0 transition-all duration-300 translate-y-4"
        id="demo-content"
    >
        <!-- Decorative Header -->
        <div class="h-32 bg-slate-900 relative overflow-hidden shrink-0">
            <div
                class="absolute inset-0 flex items-center justify-center opacity-10"
            >
                <svg
                    class="w-64 h-64 text-white"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"
                    ></path>
                </svg>
            </div>
            <div class="relative z-10 p-8 h-full flex flex-col justify-center">
                <h3
                    id="modal-title"
                    class="text-2xl font-bold text-white mb-2 leading-tight"
                >
                    Jadwalkan Demo Gratis
                </h3>
                <p class="text-slate-300 text-sm">
                    Lihat langsung bagaimana SIKES bekerja untuk sekolah Anda.
                </p>
            </div>
            <button
                id="close-demo-modal"
                class="absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors focus:outline-none focus:ring-2 focus:ring-white/50"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- Form Section -->
        <div class="p-8">
            <form id="demo-form" class="space-y-5">
                <div>
                    <label
                        for="school_name"
                        class="block text-sm font-bold text-slate-700 mb-2"
                        >Nama Sekolah</label
                    >
                    <input
                        type="text"
                        id="school_name"
                        name="school_name"
                        placeholder="Contoh: SMA Negeri 1 Jakarta"
                        class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all outline-none"
                        required
                    />
                </div>

                <div>
                    <label
                        for="wa_number"
                        class="block text-sm font-bold text-slate-700 mb-2"
                        >Nomor WhatsApp</label
                    >
                    <div class="relative">
                        <span
                            class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold"
                            >+62</span
                        >
                        <input
                            type="tel"
                            id="wa_number"
                            name="wa_number"
                            placeholder="812-3456-7890"
                            class="w-full pl-12 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all outline-none"
                            required
                        />
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2"
                        >Estimasi Jumlah Siswa</label
                    >
                    <div class="grid grid-cols-2 gap-3">
                        <label
                            class="cursor-pointer border border-slate-200 rounded-xl p-3 flex items-center justify-center hover:bg-emerald-50 hover:border-emerald-200 transition-all has-checked:bg-emerald-50 has-checked:border-emerald-500 has-checked:text-emerald-700 group"
                        >
                            <input
                                type="radio"
                                name="students"
                                value="<200"
                                class="hidden"
                            />
                            <span
                                class="text-sm font-semibold text-slate-600 group-has-checked:text-emerald-700"
                                >&lt; 200 Siswa</span
                            >
                        </label>
                        <label
                            class="cursor-pointer border border-slate-200 rounded-xl p-3 flex items-center justify-center hover:bg-emerald-50 hover:border-emerald-200 transition-all has-checked:bg-emerald-50 has-checked:border-emerald-500 has-checked:text-emerald-700 group"
                        >
                            <input
                                type="radio"
                                name="students"
                                value="200-500"
                                class="hidden"
                            />
                            <span
                                class="text-sm font-semibold text-slate-600 group-has-checked:text-emerald-700"
                                >200 - 500</span
                            >
                        </label>
                        <label
                            class="cursor-pointer border border-slate-200 rounded-xl p-3 flex items-center justify-center hover:bg-emerald-50 hover:border-emerald-200 transition-all has-checked:bg-emerald-50 has-checked:border-emerald-500 has-checked:text-emerald-700 group"
                        >
                            <input
                                type="radio"
                                name="students"
                                value="500-1000"
                                class="hidden"
                            />
                            <span
                                class="text-sm font-semibold text-slate-600 group-has-checked:text-emerald-700"
                                >500 - 1000</span
                            >
                        </label>
                        <label
                            class="cursor-pointer border border-slate-200 rounded-xl p-3 flex items-center justify-center hover:bg-emerald-50 hover:border-emerald-200 transition-all has-checked:bg-emerald-50 has-checked:border-emerald-500 has-checked:text-emerald-700 group"
                        >
                            <input
                                type="radio"
                                name="students"
                                value="1000+"
                                class="hidden"
                            />
                            <span
                                class="text-sm font-semibold text-slate-600 group-has-checked:text-emerald-700"
                                >1000+</span
                            >
                        </label>
                    </div>
                </div>

                <div class="pt-2">
                    <button
                        type="submit"
                        class="w-full py-4 bg-slate-900 text-white font-bold rounded-2xl hover:bg-slate-800 shadow-xl shadow-slate-900/10 active:scale-95 transition-all flex items-center justify-center gap-2"
                    >
                        <span>Kirim Permintaan</span>
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-5 h-5"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                        </svg>
                    </button>
                    <p
                        class="text-[10px] text-center text-slate-400 mt-4 leading-relaxed"
                    >
                        Data Anda aman. Tim kami akan menghubungi Anda via
                        WhatsApp dalam waktu maks. 24 jam kerja.
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    const modal = document.getElementById("demo-modal");
    const backdrop = document.getElementById("demo-backdrop");
    const content = document.getElementById("demo-content");
    const closeBtn = document.getElementById("close-demo-modal");
    const form = document.getElementById("demo-form");

    // Open Modal Function (Exposed to global window)
    window.openDemoModal = () => {
        if (!modal || !backdrop || !content) return;
        modal.classList.remove("hidden");
        modal.classList.add("flex");
        // Trigger reflow
        void modal.offsetWidth;

        // Animate in
        setTimeout(() => {
            backdrop.classList.remove("opacity-0");
            content.classList.remove("opacity-0", "scale-95", "translate-y-4");
            content.classList.add("scale-100", "translate-y-0");
        }, 10);
    };

    // Close Modal Function
    const closeModal = () => {
        if (!modal || !backdrop || !content) return;

        // Animate out
        backdrop.classList.add("opacity-0");
        content.classList.remove("scale-100", "translate-y-0");
        content.classList.add("opacity-0", "scale-95", "translate-y-4");

        setTimeout(() => {
            modal.classList.add("hidden");
            modal.classList.remove("flex");
        }, 300);
    };

    closeBtn?.addEventListener("click", closeModal);
    backdrop?.addEventListener("click", closeModal);

    // Initial triggers setup
    const setupTriggers = () => {
        document.querySelectorAll(".open-demo-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
                e.preventDefault();
                window.openDemoModal();
            });
        });
    };

    // Run setup immediately and on DOMContentLoaded just in case
    setupTriggers();
    document.addEventListener("DOMContentLoaded", setupTriggers);

    // Handle Form Submission
    form?.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.target as HTMLFormElement);
        const data = Object.fromEntries(formData);

        const message = `Halo Admin SIKES, saya berminat mencoba demo.%0A%0A*Nama Sekolah:* ${data.school_name}%0A*WhatsApp:* ${data.wa_number}%0A*Estimasi Siswa:* ${data.students}%0A%0AMohon info lebih lanjut. Terima kasih.`;

        // Open WhatsApp
        window.open(`https://wa.me/6285156553226?text=${message}`, "_blank");
        closeModal();
        (e.target as HTMLFormElement).reset();
    });

    // Declaration for TypeScript
    declare global {
        interface Window {
            openDemoModal: () => void;
        }
    }
</script>
